{
    "collab_server" : "",
    "contents" : "#Install tidyverse packages\n\ninstall.packages(\"tidyverse\")\ninstall.packages('backports')\ninstall.packages('broom')\ninstall.packages('lubridate')\ninstall.packages(\"dplyr\") \n\n#Load packages\n\nlibrary(\"tidyverse\")\nlibrary('lubridate')\n\n#Import datasets\n\nfars_accident <- read_csv(\"fars.accident.csv\")\nView(fars_accident)\n\nfars_person <- read_csv(\"fars.person.csv\")\nView(fars_person)\n\n\n#Query 1: How many people killed were pedestrians?\n\nfars_person_peds <- fars_person %>%\n  filter(INJ_SEV ==\"4\", PER_TYP == \"5\") %>%\n  group_by(st_case_year) %>%\n  summarise(number_records = n()) %>%\n  arrange(desc(number_records))\n\nView(fars_person_peds)\n\n\n#Answer: 951 pedestrians were killed. \n\n\nglimpse(fars_person)\n\n#Query 2: How many people killed were pedestrians and minors?\n\nfars_person_minors <- fars_person %>%\n  filter(INJ_SEV ==\"4\", PER_TYP == \"5\", AGE < 18) %>%\n  group_by(AGE, st_case_year) %>%\n  summarise(number_records = n()) %>%\n  arrange(desc(AGE))\n\nView(fars_person_minors)\n\n#63 pedestrians killed were minors\n\n\nfars_doa <- fars_person %>%\n  filter(INJ_SEV ==\"4\", PER_TYP == \"5\", AGE < 18, DOA == \"7\") %>%\n  group_by(AGE, st_case_year, DOA) %>%\n  summarise(number_records = n()) %>%\n  arrange(desc(AGE))\n\nView(fars_doa)\n\n\n#Of those 63, seven died on the scene. \n\n#Query 3: Of the above, how many were boys and how many were girls?\n\nfars_person_male <- fars_person %>%\n  filter(INJ_SEV ==\"4\", PER_TYP == \"5\", AGE < 18, SEX ==\"1\") %>%\n  group_by(AGE, st_case_year, SEX) %>%\n  summarise(number_records = n()) %>%\n  arrange(desc(AGE))\nView(fars_person_male)\n\nfars_person_female <- fars_person %>%\n  filter(INJ_SEV ==\"4\", PER_TYP == \"5\", AGE < 18, SEX ==\"2\") %>%\n  group_by(AGE, st_case_year, SEX) %>%\n  summarise(number_records = n()) %>%\n  arrange(desc(AGE))\nView(fars_person_female)\n\n#This query shows that no values for \"sex\" were reported as \"8\" (not reported) or \"9\" (unknown)\nfars_person_sex <- fars_person %>%\n  filter(INJ_SEV ==\"4\", PER_TYP == \"5\", AGE < 18, SEX ==\"8\") %>%\n  group_by(AGE, st_case_year, SEX) %>%\n  summarise(number_records = n()) %>%\n  arrange(desc(AGE))\nView(fars_person_sex)\n\n\n#33 killed were boy and 30 killed were girls. \n\n\nfars_month <- fars_person %>%\n  filter(INJ_SEV ==\"4\", PER_TYP == \"5\", AGE < 18) %>%\n  group_by(DEATH_MO) %>%\n  summarise(number_records = n()) %>%\n  arrange(desc(number_records))\nView(fars_month)\n\n# 11 pedestrians died in the month of June, 10 died in April, 8 died in July, 8 died December, 6 died in May, etc. \n\n#Query 4: How many pedestrians were involved in a car accident?\n\nfars_peds_accidents <- fars_accident %>%\n  filter(PEDS > 0) %>%\n  group_by(st_case_year, PEDS) %>%\n  summarise(number_records = n()) %>%\n  arrange(desc(st_case_year))\n\nView(fars_peds_accidents)\n\n\nfars_sch_bus <- fars_accident %>%\n  filter(FATALS > 0, SCH_BUS == \"1\")\n\nView(fars_sch_bus)\n\n#There were 1,043 reported accidents involving pedestrians. \n\n#Query 5: How many pedestrians under 18 were involved in a car accident in the state of Maryland?\n\nfars_person_maryland <- fars_person %>%\n  filter(PER_TYP == \"5\", AGE < 18, STATE ==\"24\") %>%\n  group_by(st_case_year, AGE, STATE) %>%\n  summarise(number_records = n()) %>%\n  arrange(desc(AGE))\nView(fars_person_maryland)\n\n#There were 57 incidents that resulted in pedestrian minors being struck and killed by vehicles\n\n#Query 6: In what year was the highest fatality rate for pedestrians under 18?\n\nfars_year <- peds_u_18_accidents %>%\n  group_by(YEAR) %>%\n  summarise(number_records = n()) %>%\n  arrange(desc(YEAR))\nView(fars_year)\n\n#Total minor fatalities in each year\n  #2016: 7\n  #2015: 4\n  #2014: 5\n  #2013: 9\n  #2012: 9\n  #2011: 16\n  #2010: 12 \n\n# 2011 had the highest number of fatalities involving pedestrians under the age of 18. \n\n#Query 7: What age group under 18 was most likely to be killed as a pedestrian?\n\nfars_age <- pedestrian_u_18_case_numbers %>%\n  group_by(AGE) %>%\n  summarise(number_records = n()) %>%\n  arrange(desc(number_records))\nView(fars_age)\n\n#There were 13 fatalities of 15-year-olds, nine fatalities of 16-year-olds, eight fatalities of 17-year olds, seven fatalities of 14-year olds. The top four results are teenagers, therefore older teens made up the largest portion of pedestrian fatalities of minors. \n\n#Query 8: What was the racial breakdown of pedestrian minors killed?\n\nfars_race <- pedestrian_u_18_case_numbers %>%\n  group_by(RACE) %>%\n  summarise(number_records = n()) %>%\n  arrange(desc(number_records))\nView(fars_race)\n\n#Race codes\n  #1: White\n  #2: Black\n  #99: Unkown\n  #98: All other races \n\n# 24 white children pedestrians were killed, 19 black children pedestrians were killed, and 19 children of other races were killed, while 1 child was of an unkown race. \n\n#Query 9: Were drugs involved in any of the accidents killing pedestrian minors?\n\nfars_person_drug <- pedestrian_u_18_case_numbers %>%\n  filter(INJ_SEV ==\"4\", PER_TYP == \"5\", AGE < 18, DRUGS == \"1\") %>%\n  group_by(st_case_year) %>%\n  summarise(number_records = n()) %>%\n  arrange(desc(number_records))\nview(fars_person_drug)\n\n#There was one case in which a minor pedestrian was struck and killed.\n\n#Query 10: What car make was most involved in accidents killing pedestrians under 18? \n\nfars_car_make <- peds_u_18_vehicles %>%\n  group_by(MAKE) %>%\n  summarise(number_records = n()) %>%\n  arrange(desc(number_records))\nView(fars_car_make)\n\n# 12 incidents that resulted in pedestrian minor deaths involved Ford cars; 8 involved Chevrolet cars, and 7 involved Toyota cars.\n\n#Additional Queries \n\n\nfars_per_acc_join <- fars_person %>%\n  inner_join(fars_accident, by=c(\"st_case_year\" = \"st_case_year\"))\nView(fars_per_acc_join)\n\nfars_join_left <- fars_person %>%\n  left_join(fars_vehicle, by=c(\"st_case_year\" = \"st_case_year\"))\nView(fars_join_left)\n\n#New table from fars_person\n\nfars_pedestrians <- fars_person %>%\n  filter(INJ_SEV ==\"4\", PER_TYP == \"5\", AGE < 18) %>%\n  select(st_case_year, STATE, HARM_EV, MAKE, MAK_MOD, AGE, SEX, PER_TYP, INJ_SEV, RACE) %>%\n  arrange(desc(st_case_year))\nView(fars_pedestrians)\n\n#New tables and joins\n\n\n\n#62 minors peds killed\n\npedestrian_u_18_case_numbers <- fars_person %>%\n  filter(INJ_SEV ==\"4\", PER_TYP == \"5\", AGE < 18) %>%\n  distinct(st_case_year)\nView(pedestrian_u_18_case_numbers)\n\n#\n\npedestrian_total_case_numbers <- fars_person %>%\n  filter(INJ_SEV ==\"4\", PER_TYP == \"5\") %>%\n  distinct(st_case_year)\nView(pedestrian_total_case_numbers)\n\n#936 total peds killsed. 6.6% of pedestrians killed between 2010 and 2016 were minors. \n\n\n\npeds_u_18_accidents <- fars_accident %>%\n  inner_join(pedestrian_u_18_case_numbers, by =\"st_case_year\")\nView(peds_u_18_accidents)\n\npeds_u_18_vehicles <- peds_u_18_accidents  %>%\n  inner_join(fars_vehicle, by =\"st_case_year\")\nView(peds_u_18_vehicles)\n\nView(pedestrian_u_18_case_numbers)\nView(fars_pedestrians)\n\n#New table from fars_accident\n\nfars_new_accident <- fars_accident %>%\n  select(st_case_year, STATE, YEAR, PEDS, HARM_EV, MAN_COLL, FATALS, DRUNK_DR) %>%\n  arrange(desc(st_case_year))\nView(fars_new_accident)\n\n#Join new accidents and pedestrian tables\n\nfars_inner_join <- fars_person %>%\n  left_join(fars_accident, by=c(\"st_case_year\" = \"st_case_year\"))\nView(fars_inner_join)\n\n#Total number of pedestrians killed \n\nfars_total_peds_death <- fars_accident\nfilter(PEDS > 0) %>%\n  group_by(st_case_year) %>%\n  summarise(number_records = n()) %>%\n  arrange(desc(number_records))\n",
    "created" : 1555537215743.000,
    "dirty" : false,
    "encoding" : "UTF-8",
    "folds" : "",
    "hash" : "3031670360",
    "id" : "D5C2FB60",
    "lastKnownWriteTime" : 1557457119,
    "last_content_update" : 1557457119393,
    "path" : "~/Desktop/fars_exercise/script.r",
    "project_path" : "script.r",
    "properties" : {
        "tempName" : "Untitled1"
    },
    "relative_order" : 1,
    "source_on_save" : false,
    "source_window" : "",
    "type" : "r_source"
}